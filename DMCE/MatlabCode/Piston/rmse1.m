mu=[  56.72749999999997  56.25964746516307  56.51768178365280  56.53205821425562];

si=[3.48440208333334   4.11695683927347   3.63208806465274   3.48539079212917];

beta0= [
   0.02250000000003  -2.22970939596501  -0.55473229766242  -0.56483354136278
   0.92250000000006   3.46363103986515   1.12102122488036   1.80108665656768
  -2.75749999999997  -4.01560831896110  -1.49084773723854  -1.89518942412954
   2.04250000000004   1.34343449914094   2.43186542821453   2.38946688313278
  -0.38749999999997   0.72169111907329   0.57957638550628  -0.57195314265750
   0.12250000000003   0.00305383332517  -0.69641750016449  -1.26074270547951
  -0.04750000000025   1.19434791857423   0.11945126021751  -0.54206761348624
   1.72250000000003  -1.35638413163523   2.14639977109297   1.54297570863446
  -1.22749999999997  -0.51327274412463  -2.47237894227630  -1.74436596354077
  -3.95749999999997  -3.83668969824933  -3.26514718473346  -3.57609777565365
   0.63250000000003  -1.78982576957102   1.03186590671271   0.81279306947742
   2.91250000000003   7.01533164852743   3.91486827411173   3.60892784849752];

 
 
gamma0=[
     0.13971729636403   0.00082327821858   0.00166978761216   0.00377634396164
   1.63003512424697   0.00000018569523   0.00014179116251   0.02432604261031
   2.44505268637046   0.04268897371940   0.57785376347901   0.29086752208405
   4.09135569091184   0.00000056138195   0.00020223870912   0.03264154670866
   4.09135569091184   0.00000302741253   0.15014745443298   0.09798060789481
  12.22526343185230   4.62685914932326   0.01481465890209   0.25899413634225
];
 
 
load('piston12.m')
data = piston12;
x=data(:,2:7);

load('piston100.m')
data = piston100;
z=data(:,2:7);
y=data(:,8);

xt = x;

n=size(x,1);
q=2;

for k=1:100
   xv = z(k,:);
   R = exp(-sum( ((xt'-xv'*ones(1,n)).^q).*(gamma0(:,1)*ones(1,n)))); 
   	% correspond to b in the paper
   rss(k,1) = abs(y(k) - mu(1) - R*beta0(:,1))^2;
   
	R = exp(-sum( ((xt'-xv'*ones(1,n)).^q).*(gamma0(:,2)*ones(1,n))));
   rss(k,2) = abs(y(k) - mu(2) - R*beta0(:,2))^2;
   
	R = exp(-sum( ((xt'-xv'*ones(1,n)).^q).*(gamma0(:,3)*ones(1,n))));
   rss(k,3) = abs(y(k) - mu(3) - R*beta0(:,3))^2;
   
	R = exp(-sum( ((xt'-xv'*ones(1,n)).^q).*(gamma0(:,4)*ones(1,n))));
   rss(k,4) = abs(y(k) - mu(4) - R*beta0(:,4))^2;
   
end;

mean(rss)

boxplot(rss);
ylabel('Prediction Error')
xlabel('Kriging                          SCAD                                  L_1                                    L_2')